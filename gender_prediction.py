# -*- coding: utf-8 -*-
"""Gender Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/131DdT9PF1wkGboUX7Q-YBwoXQJKrP2kq
"""

!pip install scikit-learn==0.21.3

!pip install bangla-linga

pip install bnbphoneticparser

from bangla_linga import gender_prediction as gp
from bnbphoneticparser import BanglishToBengali
gen = gp.BN_gen_pred()
banglish2bengali = BanglishToBengali()

import pandas as pd
df = pd.read_excel("users.xlsx")

df.head()

"""# New Section"""

df["bn_full_name"] = df["full_name"].apply(lambda x: banglish2bengali.parse(x.lower().strip()))

df.head()

def get_gender(name):
  try:
    return gen.predict_gender(name)
  except:
    return "error"

df.head().apply(lambda x: get_gender(x['bn_full_name']) if pd.isna(x["gender"])  else x["gender"], axis=1)

import numpy as np
df["gender"] = df.apply(lambda x: get_gender(x['bn_full_name']) if pd.isna(x["gender"])  else x["gender"], axis=1)

df.head()

df['gender']=df["gender"].apply(lambda x: 1.0 if x=='male' else x)

df['gender']=df["gender"].apply(lambda x: 0.0 if x=='female' else x)

df.head()

df['gender']=df["gender"].apply(lambda x: 'male' if x== 1.0 else x)

df['gender']=df["gender"].apply(lambda x: 'female' if x== 0.0 else x)

df.head()

gen.predict_gender("শাহ সুলতান রাউনাক")

